(this.$WP=this.$WP||[]).push(["lOKOGh",(t,e)=>{"use strict";var r,a,n=()=>{var[t,e]=r.useState("idle"),[n,s]=r.useState([]),[i,u]=r.useState(new Map),[c,o]=r.useState(null);return{status:t,restaurants:n,restaurantsMap:i,currentRestaurant:c,fetchAll:r.useCallback(((t,r)=>(e("fetching"),a.instance.fetchRestaurants(t,r).then((({restaurantsList:t,restaurantsMap:r})=>(s(t),u(r),e("success"),{restaurantsList:t,restaurantsMap:r}))).catch((t=>(s([]),u(new Map),e("failed"),t))))),[]),fetchOne:r.useCallback(((t,r)=>(e("fetching"),((t,e)=>fetch(`https://dining-club-api.helloreco.com/diningClub/${e}`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json; charset=utf-8"}}).then((t=>{if(t.ok)return t;throw Error(JSON.stringify(t))})).then((t=>t.json())).then((t=>{try{var e,r=JSON.parse(t.body);if(null!=r&&null!=(e=r.restaurant_data)&&e.length){var[{geoIds:a,restaurant:n}]=r.restaurant_data;return{restaurant:JSON.parse(n),geoId:parseInt(a[0]||"",10)}}}catch{console.error("[DiningClubTest] Failed to parse restaurant data")}return null})))(0,r).then((t=>(e("success"),o(t),t))).catch((t=>(o(null),e("failed"),t))))),[])}};return[()=>{(a=class{constructor(){this.requestsMap=new Map}fetchRestaurants(t,e){var r=this.requestsMap.get(t);if(r)return r;var a=((t,e)=>t.then((t=>{if(t.ok)return t;throw Error(JSON.stringify(t))})).then((t=>t.json())).then((t=>{try{var r=JSON.parse(t.body),a=(Array.isArray(null==r?void 0:r.restaurants)?r.restaurants:[]).map((t=>{var r=null;return"gemini_dining_club_20_percent"===e&&(r=20),"gemini_dining_club_variable_discount"===e&&(r=t.promotionPercentage),{...t,promotionPercentage:r}})),n=a.reduce(((t,e)=>{var r;return t.set(null==(r=e.object)?void 0:r.locationId,e)}),new Map);return{restaurantsList:a,restaurantsMap:n}}catch{return console.error("[DiningClubTest] Failed to parse restaurants data"),{restaurantsList:[],restaurantsMap:new Map}}})))(fetch(`https://dining-club-api.helloreco.com/diningClub/geo/${t}`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json; charset=utf-8"}}),e);return this.requestsMap.set(t,a),a}}).instance=void 0,a.instance=new a,t("default",n)},[t=>r=t]]},["cDcdfi"]]);
