(this.$WP=this.$WP||[]).push(["fTyhRT",(e,r)=>{"use strict";var t,l,u,i,n,a,d,s,o,T,I,c,v,p=e=>{var[,r]=d(i),[l,u]=t.useState({fetching:!1}),n=o("SAVE_TO_TRIP"),a=t.useRef(!0),T=t.useCallback((e=>{a.current&&u(e)}),[]);if(t.useEffect((()=>()=>{a.current=!1}),[]),!e)return[l,()=>Promise.resolve([null,null])];var I=e;return[l,e=>(T({fetching:!0}),r({tripId:e,referenceId:`${I.id}`,referenceType:I.type,allowDuplicates:!1}).then((e=>{var r,t,l,u,i,a,d=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,o=null==e||null==(l=e.data)||null==(u=l.addItemToTrip)||null==(i=u.errors)||null==(a=i[0])?void 0:a.error;if(d){var c=s(d,I);c?(n(),T({fetching:!1,result:{trip:d,tripItem:c}})):"bundleSave"===I.type?T({fetching:!1,result:{trip:d,tripItem:{__typename:"TripItem",id:0,comments:[]}}}):T({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:o}})}else T({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:o}});return[d,o]})).catch((e=>(console.error(e),T({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),[null,null]))))]},f="mostRecentlyAddedToTrip",h=(e,r,t,i)=>{var[n,a]=c(r),{userId:d}=l(I);return[n,u((()=>{var l=null!=e?e:(e=>{var r=T.get(f);return r&&r.userId===e?r.tripId:null})(d);return t||!l||v.has(null==r?void 0:r.type)?(i&&i(),Promise.resolve([null,null])):a(l)}),[t,r,i,a,d,e]),e=>((e,r)=>{r?T.set(f,{tripId:e,userId:r},144e5):T.remove(f)})(e,d)]},m=(e,r,l)=>{var[u,i]=t.useState({fetching:!1,saved:!!l}),[,s]=d(n),[,o]=d(a);return[u,l?()=>l?(i({...u,fetching:!0}),o({itemId:l.id,tripId:r}).then((e=>{var r,t=null==e||null==(r=e.data)?void 0:r.tripsRemoveItem;return t?(i({fetching:!1,saved:!1,result:{trip:t}}),u):(i({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),u)})).catch((()=>(i({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),u)))):Promise.resolve(u):()=>(i({...u,fetching:!0}),s({tripId:r,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1}).then((e=>{var r,t,l,n,a,d,s,o,T,I=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,c=null==e||null==(l=e.data)||null==(n=l.addItemToTrip)||null==(a=n.errors)||null==(d=a[0])?void 0:d.error;if(c||!I)return i({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:c||void 0}}),u;var v=null==e||null==(s=e.data)||null==(o=s.addItemToTrip)||null==(T=o.items)?void 0:T[0];return i(v?{fetching:!1,saved:!0,result:{trip:I,tripItem:v}}:{fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),u})).catch((()=>(i({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),u))))]};return[()=>{c=p,v=new Set(["savesItem","bundleSave"]),e({useAutosave:h,useSave:c,useTripSaveToggle:m})},[e=>(t=e,l=e.useContext,u=e.useCallback),e=>(i=e.AddItemToTrip,n=e.AddItemWithFullTrip,a=e.RemoveItemWithFullTrip),e=>d=e.useMutation,e=>s=e.getItemByReference,e=>o=e.usePixelCallback,e=>T=e.default,e=>I=e.Visitor]]},["cDcdfi","RXx5aI","5X2em-","eFKnUp","jb_4W2","jaCyxS","2R4xv2"]]);
