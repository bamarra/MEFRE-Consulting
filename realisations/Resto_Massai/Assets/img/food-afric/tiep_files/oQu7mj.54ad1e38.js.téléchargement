(this.$WP=this.$WP||[]).push(["oQu7mj",(e,t)=>{"use strict";var s,r,n,i,a,o,d,l,u=(e,t,s)=>fetch("/data/1.0/tap/recordEvent",{method:"POST",body:JSON.stringify({eventType:e,requestGuid:t.tripAdsGuid,payloadToken:t.tripAdsPayloadToken,externalId:t.adReqUniqueId}),credentials:"same-origin",headers:{"content-type":"application/json","x-requested-by":s}}).then((e=>(e.ok||e.statusText,!0))).catch((e=>(e.message,!1))),c=(e,t,s,r)=>fetch("/AdRequestEventLogApi/1.0/logEvent",{method:"POST",body:new URLSearchParams({event:e,requestId:t.adReqUniqueId,adUnit:t.sponsoredSlot,servlet:s,url:window.location.pathname}),credentials:"same-origin",headers:{"content-type":"application/x-www-form-urlencoded","x-requested-by":r}}).then((e=>(e.ok||e.statusText,!0))).catch((e=>(e.message,!1))),p=/[A-Za-z_]+/,m=e=>{var t=document.createElement("a");t.href=e;var s=p.exec(t.pathname),r=s?s[0]:"Invalid";return"Commerce"===r?"Redirect":r},I=(e,t,s,r,n)=>{if(e){n();var i=u("IMPRESSED",e,r),a=c("IMPRESSION",e,s,r);Promise.all([i,a]).then().catch((e=>{e.message}))}},_=e=>{var{sponsoredListingInfo:t,locationId:n,page:d,securityToken:l}=e,u=a("restaurants_sp_simplified_tracking_full"),c=a("restaurants_sp_simplified_tracking_shadow");return t?u?s.createElement(o,{trackingKey:(null==t?void 0:t.adReqUniqueId)||""},e.children(s.createRef())):c?s.createElement(r,{impression_details:{sponsoredSlotName:(null==t?void 0:t.sponsoredSlot)||"",locationId:n,tripAdsId:(null==t?void 0:t.tripAdsId)||"",restaurantsRequestGuid:(null==t?void 0:t.adReqUniqueId)||""},impressionType:"ad_visible"},(r=>s.createElement(o,{trackingKey:(null==t?void 0:t.adReqUniqueId)||"",shadowMode:!0,additionalCallbacks:()=>{I(t,0,d,l,r)}},e.children(s.createRef())))):s.createElement(r,{impression_details:{sponsoredSlotName:(null==t?void 0:t.sponsoredSlot)||"",locationId:n,tripAdsId:(null==t?void 0:t.tripAdsId)||"",restaurantsRequestGuid:(null==t?void 0:t.adReqUniqueId)||""},impressionType:"ad_visible"},(r=>s.createElement(i,{onVisible:()=>{t&&I(t,0,d,l,r)}},(t=>e.children(t))))):e.children(s.createRef())},g=e=>{var{adSelected:t,noAdSelected:r}=e,i=[];if(a("restaurants_sp_simplified_tracking_full"))return e.children||null;for(var o=0;o<t.length;o++){var{restaurantsRequestGuid:d,sponsoredSlotName:l,locationId:u,tripAdsId:c}=t[o];i.push(s.createElement(n,{key:u,shouldLogOnMount:t.length>0,impression_details:{restaurantsRequestGuid:d,sponsoredSlotName:l,locationId:u,tripAdsId:c},impressionType:"ad_selected"},null))}return s.createElement(s.Fragment,null,i,s.createElement(n,{shouldLogOnMount:r.length>0,impression_details:r,impressionType:"no_ad_selected"},null),e.children)},h=e=>{switch(e){case"DETAIL_PAGE":return"DETAIL_LINK";case"MENU_LINK":return"MENU_LINK";case"BOOKING_BUTTON":case"COMMERCE_BUTTON":return"COMMERCE_BUTTON";case"REVIEW_SNIPPET":return"REVIEW_SNIPPET";default:return"UNKNOWN"}},f=e=>{var{sponsoredInfo:t,locationId:s,page:r,detailPageUrl:n,securityToken:i,interactionLogger:o,visitor:p,marketingCampaignId:I}=e,_=a("restaurants_sp_simplified_tracking_full"),g=a("restaurants_sp_simplified_tracking_shadow"),f=_||g?null==t?void 0:t.adReqUniqueId:null,v=d({marketingCampaignId:I});if(!t)return()=>Promise.resolve();if(_)return e=>v({trackingKey:f,shadowMode:g,surfaceType:h(e)}).then((()=>Promise.resolve()));var{sponsoredSlot:E,tripAdsId:S,adReqUniqueId:T}=t;return e=>{if(!a("restaurants_list_cell_more_sponsored_clicks")&&e&&"BOOKING_BUTTON"!==e&&"DETAIL_PAGE"!==e)return Promise.resolve();o({Restaurants:{sponsoredListingClick:{locationId:s,servletName:r||"",sessionId:p.sessionId,lastReferrer:"undefined"!=typeof document&&document.referrer||"",userAgent:"undefined"==typeof navigator?"undefined":navigator.userAgent,userId:p.userId,sponsoredSlotName:E||"",tripAdsId:S||"",restaurantsRequestGuid:T||""}}});var d=((e,t,s,r,n)=>{var i=JSON.stringify({slot:e.locationListIndex,location_id:t,area:e.sponsoredSlot,from:m(window.location.href),dest:m(s),sl_line_item_id:e.slLineItem,trip_ads_id:e.tripAdsId,clicked_cta_type:n||null,ad_request_guid:e.adReqUniqueId});return fetch("/SponsoredListingCommerce/1.0/click",{method:"POST",body:i,credentials:"same-origin",headers:{"content-Type":"application/json","x-requested-by":r}}).then((e=>(e.ok||e.statusText,!0))).catch((e=>(e.message,!1)))})(t,s,n,i,e),I=u("CLICKED",t,i),_=c("CLICK",t,r,i);a("ungate_sponsored_listing_clicks")&&l.set("sponsoredListingIdClicked",s,3e5);var k=g?v({trackingKey:f,shadowMode:g,surfaceType:h(e)}).then((()=>{})):Promise.resolve();return Promise.all([d,I,_,k]).then((()=>{})).catch((()=>{}))}};return[()=>{e({SponsoredImpressionTracker:_,SponsoredSelectionTracker:g,useSponsoredClickTracker:f})},[e=>s=e,e=>(r=e.EatImpressionOnCallback,n=e.EatImpressionOnMount),e=>i=e.HasBeenVisible,e=>a=e.featureIsEnabled,e=>(o=e.SpImpression,d=e.useSpInteractionLogger),e=>l=e.default]]},["cDcdfi","ew-Uau","BLrxBS","-i3PJS","Yx-VR7","jaCyxS"]]);
