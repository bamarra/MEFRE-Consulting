(this.$WP=this.$WP||[]).push(["BqoTCX",(e,t)=>{"use strict";var i,a,s,n,o,l,r,d,c,p,m,u,h,g,v,k,b,_,f,N,S,D,O,y,w,E,T,I,P,F,C,A,R,L,x,G,M,V,B,H,U,q,z,W,K,X,Q,j,J=e=>{x().dispatch(G.page.hotels.setGoogleOneTapOpen(e))},$="dJfZT D G5",Y=({mutation:e,variables:t,onCompleted:a,className:s,children:n,textInputIsValid:o})=>i.createElement(w,{query:e},(({executeMutation:e})=>i.createElement("form",{className:s,onSubmit:i=>{i.preventDefault&&i.preventDefault(),o()&&e(t).then((({data:e})=>{a&&a(e)}))}},n))),Z="homePromptDismissed",ee=["CheapFlightsSearchResults","CheapFlightsSearchDeals","MobileCheapFlightsSearchResults","MobileCheapFlightsSearchDeals","OptimusHotelCheckout","OptimusSubscriptionCheckout"],te=e=>{var t=u("mobile_web"),{notifyAdhesion:i}=a.useContext(y),[{page:l,params:r}]=s(T),{newPlusSubscriber:d=!1}=r,c="Hotels"===l||"Hotel_Review"===l,p={};t&&(e.adhesionRendered?(p={bottom:"50px"},i(!0)):p={bottom:"0"});var[g,v]=n({type:"location_id",value:"1",displayValue:""}),[_,f]=n(""),[w,I]=n(!1),P=e=>{f(e)},F=e=>{v(e),f(e.value)},C=t?"fwdGW":"buCFU",A=t?"flcWq":"dQFBO",R={hometown:g.value||null,userId:e.userId},L=t=>{k({module:"Home_Location_Prompt",action:t,context:e.servlet||"unknown"})};return o((()=>{if(e.ipGeoId&&e.ipGeoId>1&&e.ipGeoNameAndParentName&&""!==e.ipGeoNameAndParentName){var t={type:"location_id",value:e.ipGeoId.toString(),displayValue:e.ipGeoNameAndParentName};v(t),f(t.value)}}),[e.ipGeoId,e.ipGeoNameAndParentName]),a.createElement(E,{query:W,variables:{userId:e.userId}},(({fetching:i,data:s})=>{var n,o;return i||(t=>{var i,a,s,n,o=!u("home_location_prompt_master"),l=null==t||null==(i=t.memberProfile)||null==(a=i.hometown)?void 0:a.locationId,r=Date.now()-((null==t||null==(s=t.insightProfile)||null==(n=s.uiCardsState)?void 0:n.timestamp)||0)<864e5,p=N.get(Z),m=ee.includes(e.servlet),h=u("optimus_date_picker_test_a"),g=u("optimus_date_picker_test_b");return e.isDatePickerOpen&&c&&(h||g)||d||e.isInterstitialOpen||o||l||r||p||m})(s)?null:(w||(L("Shown_Prompt"),I(!0)),e.onShown(),a.createElement(H,{variables:R,onCompleted:t=>{var i;"OK"===(null==t||null==(i=t.updateMemberProfile)?void 0:i.status)&&(L("Change_Location"),e.onComplete(!0))},textInputIsValid:()=>g&&""!==g.value&&g.value===_,mutation:q},a.createElement("div",{className:m("bRRjU D C z",C),style:p},a.createElement("span",{className:"bomhx"},null!=s&&null!=(n=s.memberProfile)&&n.avatar?a.createElement(D,{photo:null==s||null==(o=s.memberProfile)?void 0:o.avatar}):a.createElement(O,{name:"member",className:"eqxCa"})),a.createElement(b,{colorVariant:"TA_GRAY_3",onClick:()=>{N.set(Z,!0),L("Closed_Prompt"),e.onDismiss()}}),a.createElement("div",{className:A},a.createElement("p",{className:"ezKKe"},h("I_live_in")),a.createElement("p",{className:"dMTid"},h("home_location_things_near_you")),a.createElement("div",{className:"MbTvN"},a.createElement("div",{className:"feBWi"},a.createElement(S,{className:"fEQAj",selectedLocation:g,selectionChanged:F,textInputChanged:P,iconType:"map-pin-fill",mode:"cities",includeWorld:!1,resultsAbove:t,max:t?4:8})),a.createElement("button",{className:"fkdTo"},a.createElement(O,{name:"arrow-right",className:"jSkfn"})))))))}))},ie=()=>{var[e,t]=i.useState(!1),a=i.useCallback((()=>{t(!0)}),[]),s=i.useCallback((e=>{v("cpm_mw_adhesion").emit("dialog_shown",e)}),[]);return i.useEffect((()=>(v("cpm_mw_adhesion").on("ad_closed",a),()=>{v("cpm_mw_adhesion").off("ad_closed",a)})),[a]),i.useMemo((()=>({adhesionClosed:e,notifyAdhesion:s})),[e,s])},ae=[40185,40600],se=e=>{var t=X();return i.createElement(y.Provider,{value:t},i.createElement(V,e))};return[()=>{M=class extends i.Component{constructor(e){super(e),this.onFacebookLoadSdkAndInit=()=>{window.require(["facebook/authutils"],(e=>{e.loadSdkAndInit(this.props.fbSdkUrl,this.props.fbConnectAppId,this.props.fbApiVersion),e.queueForInit(this.onFacebookInit)}))},this.onFacebookInit=()=>{this.setState({fbSdkInitialized:!0}),window.FB.Event.subscribe("xfbml.render",(()=>{this.trackAction("facebook_onetap_rendered")})),window.FB.getLoginStatus((e=>{"connected"===e.status||"not_authorized"===e.status?this.setState({fbUserLoggedIn:!0}):(this.setState({disabled:!0}),this.props.triggerNext())}))},this.onFacebookLogin=()=>{this.trackAction("facebook_onetap_clicked"),window.FB.getLoginStatus((e=>{if("connected"===e.status){var{authResponse:t}=e;t&&t.accessToken&&this.onFacebookAccountConnected(t.signedRequest)}}))},this.onFacebookAccountConnected=e=>{var t=this.parseFBSignedRequest(e);t&&t.code&&(p.set("FacebookAuthCode2",t.code,{expires:new Date((new Date).getTime()+5e3),domain:this.props.cookieDomain,path:"/"}),window.require(["ta/registration/RegOverlay"],(e=>{var t="MOBILE"===this.props.viewportCategory;e.showRegOverlay(null,null,t,{flow:"FACEBOOK_ONETAP",pid:40600,userRequestedForce:"true",extraQueryParams:{social:"true"},displayOnShowOverlay:!0,onClose:()=>{this.dismissFbOneTap()},onSuccess:e=>{this.disableFbOneTap(),e&&e.user_id&&(this.props.trackWouldOpenExplicitPreferences&&this.props.trackWouldOpenExplicitPreferences(),this.props.explicitPreferencesEnabled&&this.props.openExplicitPreferences&&this.props.openExplicitPreferences())}})})))},this.parseFBSignedRequest=e=>{if(!e)return null;var t=e.split(".",2)[1];if(t){var i=atob(t);try{return JSON.parse(i)}catch(e){this.trackAction("facebook_onetap_parseSignedRequestFailed")}}return null},this.dismissFbOneTap=()=>{this.disableFbOneTap(),this.trackAction("facebook_onetap_closed"),this.props.onDismiss()},this.disableFbOneTap=()=>{this.state.disabled||this.setState({disabled:!0})},this.handleGPTSlotRendering=()=>{this.setState({skyAdsRendered:!0})},this.state={fbSdkInitialized:!1,fbUserLoggedIn:!1,disabled:!u("facebook_onetap_mobile")&&!u("facebook_onetap_desktop")}}UNSAFE_componentWillMount(){this.state.disabled&&this.props.triggerNext()}componentDidMount(){this.state.disabled?this.props.triggerNext():(this.trackAction("facebook_onetap_requested"),u("hr_defer_facebook_sdk")||u("h_defer_facebook_sdk")?v("TimeToInteractive").on("TimeToInteractive",this.onFacebookLoadSdkAndInit):this.onFacebookLoadSdkAndInit())}trackAction(e){k({module:"facebook_onetap",action:e,context:`${this.props.servlet||"unknown"}`})}render(){if(v("cpm_mw_adhesion").emit("dialog_shown",!this.state.disabled),this.state.disabled||!this.state.fbSdkInitialized||!this.state.fbUserLoggedIn)return null;var e;e=this.props.adhesionRendered?50:0;var t={headline:h("onetap_message_unlock"),subhead:h("onetap_subhead_signin_alerts_deals")};return window.onFacebookOneTapLogin=this.onFacebookLogin,setTimeout((()=>{window.FB.XFBML.parse()}),50),i.createElement("div",{className:"MOBILE"===this.props.viewportCategory?m($,"bnNVo"):m($,"bwBvr",this.state.skyAdsRendered?"bVoUD":""),style:{bottom:"MOBILE"===this.props.viewportCategory?`${e}px`:"unset"}},i.createElement(b,{onClick:this.dismissFbOneTap}),i.createElement("div",{className:"fmnOf"},i.createElement("div",{className:"bVKYd"},i.createElement("div",null,t.headline)),i.createElement("p",{className:"cFLEX"},t.subhead),i.createElement("div",{className:"bXrtz"},i.createElement("div",{className:"bfNuX"},i.createElement("div",{className:"fb-login-button","data-width":"100%","data-max-rows":"1","data-size":"large","data-button-type":"continue_with","data-show-faces":"true","data-auto-logout-link":"false","data-use-continue-as":"true","data-scope":"email,user_hometown,user_friends,user_likes,user_location,user_status,user_photos","data-onlogin":"window.onFacebookOneTapLogin();",style:{width:"100%"}}))),i.createElement("div",{className:"dCDDX"},g(h("terms_and_policy_links",{0:"/pages/terms.html",1:"/pages/privacy.html",2:"legalLink"})))),i.createElement(_,{size:"5x1",position:"sky",callback:this.handleGPTSlotRendering}))}},B=c((e=>({fbApiVersion:e.auth.fbApi.apiVersion,fbConnectAppId:e.auth.fbApi.facebookConnectAppId,fbSdkUrl:e.auth.fbApi.sdkUrl,servlet:e.meta.initialServletName,cookieDomain:e.meta.cookieDomain,viewportCategory:e.meta.device.viewportCategory})))(M),Y.defaultProps={onCompleted:()=>{},className:"",children:null},H=Y,(U=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"HomeLocationEdit"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"hometown"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"updateMemberProfile"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"userId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"userId"}}},{"kind":"Argument","name":{"kind":"Name","value":"hometown"},"value":{"kind":"Variable","name":{"kind":"Name","value":"hometown"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"status"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":149}}')).__key=45378370068463,q=U,(z=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"HomeLocationQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"memberProfile"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"userId"},"value":{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"id"},"value":{"kind":"Variable","name":{"kind":"Name","value":"userId"}}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"avatar"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"id"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"photoSizes"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"width"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"height"},"arguments":[],"directives":[]}]}}]}},{"kind":"Field","name":{"kind":"Name","value":"hometown"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"locationId"},"arguments":[],"directives":[]}]}}]}},{"kind":"Field","name":{"kind":"Name","value":"insightProfile"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"uiCardsState"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"timestamp"},"arguments":[],"directives":[]}]}}]}}]}}],"loc":{"start":0,"end":300}}')).__key=0xad506b83a768,W=z,K=l(((e,t)=>{var i=t("/data/1.0/homelocation/ipGeoInfo");return()=>{var t=i&&i.get().data;return{servlet:e.meta.initialServletName,userId:e.auth.loggedInUserId,viewportCategory:e.meta.device.viewportCategory,ipGeoId:null==t?void 0:t.ipGeoId,ipGeoNameAndParentName:null==t?void 0:t.ipGeoNameAndParentName,isDatePickerOpen:e.page.isDatePickerOpen,isInterstitialOpen:e.page.isInterstitialOpen}}}))(te),X=ie,Q=L.component.onUsage((()=>t("454gno")),"default"),V=class e extends i.Component{static isQualtricsEnabled(){return new Promise((e=>{u("qualtrics_surveys_any")&&window.require(["ta/support/Qualtrics"],(t=>{e(t.seenThisPageView()||t.canDisplaySmart()||t.canDisplay())})),e(!1)}))}constructor(e){super(e),this.onGoogleOneTapDismiss=()=>{I(this.props.sessionId),J(!1)},this.onGoogleOneTapTriggerNext=()=>{this.setState({dialogType:"FACEBOOK_ONETAP"})},this.onFacebookOneTapDismiss=()=>{I(null)},this.onFacebookOneTapTriggerNext=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationDismiss=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationComplete=()=>{this.setState({dialogType:"NONE"})},this.onHomeLocationShown=()=>{v("home-location-prompt").emit("shown")},this.onRegistrationOverlayShown=(e,t)=>{ae.includes(t)||this.setState({dialogsDisabled:!0})},this.setupRegDialog=()=>{if(v("Onboarding").on("loginSuccess",this.disableDialog),v("registration-overlay").on("shown",this.onRegistrationOverlayShown),v("FlightList").on("AirwatchInterstitialOpened",this.disableDialog),P.includes(this.props.servlet)||"ShowUserReviews"===this.props.servlet||"MobileShowUserReviews"===this.props.servlet){if(v("DatePicker").on("clicked",this.disableDialog),v("global-nav").on("sidebarOpened",this.disableDialog),v("hotels-sort-filter-entry").on("openSort",this.disableDialog),v("hotels-sort-filter-entry").on("openFilters",this.disableDialog),v("hr-persistent-footer").on("show",this.disableDialog),v("h-map").on("open-trigger-clicked",this.disableDialog),v("h-map").on("toggle-trigger-clicked",this.disableDialog),v("rooms-guests").on("popped",this.disableDialog),this.props.defaultDates&&!f.wasDismissed(this.props.detailPage)&&"MOBILE"===this.props.viewportCategory)return v("rooms-guests").on("firstUserUpdate",this.enableDialog),v("picker-autoadvance").on("flow-complete",this.enableDialog),void v("pop-calendar").on("dismissed",this.enableDialog);v("responsiveStayDates").on("calendarInteracted",this.disableDialog)}if(u("disable_reg_dialog_for_hardgate")&&"GOOGLE_ONETAP"===this.initialDialogType&&this.props.isGatingPageCountTriggerReached)this.disableDialog();else{if(!F()){var e=window.googletag||{cmd:[]};return e.cmd.push((()=>{e.pubads().addEventListener("slotRenderEnded",(e=>{(null==e?void 0:e.advertiserId)!==A&&this.setState({adhesionRendered:!0}),this.enableDialog()}))})),v("cpm_mw_adhesion").on("ad_closed",(()=>{this.setState({adhesionRendered:!1})})),void setTimeout(this.enableDialog,4e3)}this.enableDialog()}},this.initialDialogType=void 0,this.decideInitialDialogType=()=>{var e=!this.props.isMember&&!C(this.props.sessionId),t=this.props.isMember,i="NONE";return e?i="GOOGLE_ONETAP":t&&(i="HOME_LOCATION_PROMPT"),i},this.enableDialog=()=>{"NONE"===this.state.dialogType&&this.setState({dialogType:this.initialDialogType})},this.disableDialog=()=>{"NONE"!==this.state.dialogType&&this.setState({dialogType:"NONE",dialogsDisabled:!0})},this.state={dialogType:"NONE",adhesionRendered:!1,dialogsDisabled:!1}}componentDidMount(){this.initialDialogType=this.decideInitialDialogType(),"NONE"!==this.initialDialogType?e.isQualtricsEnabled().then((e=>{e||this.setupRegDialog()})):v("reg_dialog").emit("all_dismissed")}componentDidUpdate(e){!e.isMember&&this.props.isMember&&this.disableDialog()}isAdhesionRendered(){return R()||this.state.adhesionRendered}render(){var{dialogsDisabled:e,dialogType:t}=this.state,a=()=>null,s=[],n="registration_dialog";if(e)return null;switch(t){case"GOOGLE_ONETAP":s=["google_one_tap"],a=({dismiss:e})=>i.createElement(Q,{onDismiss:()=>{e(),this.onGoogleOneTapDismiss()},onShow:()=>J(!0),triggerNext:this.onGoogleOneTapTriggerNext,servletName:this.props.servlet}),n="google_one_tap";break;case"FACEBOOK_ONETAP":s=["facebook_one_tap"],a=({dismiss:e})=>i.createElement(B,{onDismiss:()=>{e(),this.onFacebookOneTapDismiss()},triggerNext:()=>{e(),this.onFacebookOneTapTriggerNext()},adhesionRendered:this.isAdhesionRendered()}),n="facebook_one_tap"}var o=null;return this.props.isDatePickerPage||(o=i.createElement(r,{factory:()=>null,eventTypes:["skip_100"],renderKey:"skip_100",tier:100,skip:!0})),"HOME_LOCATION_PROMPT"===t?i.createElement(i.Fragment,null,o,i.createElement(K,{adhesionRendered:this.isAdhesionRendered(),onDismiss:this.onHomeLocationDismiss,onShown:this.onHomeLocationShown,onComplete:this.onHomeLocationComplete})):this.props.isMember||C(this.props.sessionId)||this.props.isPaywallBlocking?i.createElement(i.Fragment,null,o,i.createElement(r,{factory:a,eventTypes:["skip_200"],renderKey:"skip_200",tier:200,skip:!0})):s.length>0?i.createElement(i.Fragment,null,o,i.createElement(r,{factory:a,eventTypes:s,renderKey:n,tier:200})):null}},j=l({data:(e,t)=>(K.stage(e,t),()=>{var t,i,a,s,n;return{isMember:e.auth.isMember,isDatePickerPage:e.page.isDatePickerPage,isPaywallBlocking:e.page.isPaywallBlocking,sessionId:e.tracking.sessionId,viewportCategory:e.meta.device.viewportCategory,servlet:e.meta.initialServletName,defaultDates:!!(e.travelerInfo.hotels||{}).defaultDates,detailPage:!(null==(t=e.page)||!t.detailId),isGatingPageCountTriggerReached:d((null==(i=e.lithiumRoute)||null==(a=i[0])?void 0:a.page)||"Unknown",(null==(s=e.lithiumRoute)||null==(n=s[0])?void 0:n.params)||{})}}),actions:{}})(se),e("default",j)},[e=>(i=e,a=e.default,s=e.useContext,n=e.useState,o=e.useEffect),e=>l=e.bind,e=>r=e.PopupHierarchyRender,e=>d=e.pageCountTriggerReached,e=>c=e.connect,e=>p=e.default,e=>m=e.default,e=>u=e.featureIsEnabled,e=>(h=e.localize,g=e.unescaped),e=>v=e.createRadio,e=>k=e.default,e=>b=e.CloseIcon,e=>_=e.ListenToGPTSlotRendering,e=>f=e.default,e=>N=e.default,e=>S=e.GeoSelector,e=>D=e.Avatar,e=>O=e.Icon,e=>y=e.PromptsContext,e=>(w=e.Mutation,E=e.Query),e=>T=e.Route,e=>(I=e.setRegDialogDismissed,P=e.HOTEL_SERVLETS,F=e.shouldIgnoreAdhesionUnit,C=e.shouldSuppressRegistrationDialog),e=>(A=e.ADHESION_COLLAPSE_ADVERTISER_ID,R=e.doesAdExistOnPage),e=>L=e,e=>(x=e.getStore,G=e.actions)]]},["cDcdfi","RiHMo-","FAXpyL","wU942v","h74DsO","vmXh3M","jSLlaY","-i3PJS","535agn","l6BSGt","Jk5sjx","xegF5W","w2XwHO","IuX4Ar","jaCyxS","zPgUM0","Hgrhyo","_qQcW3","HDgDKt","5X2em-","2R4xv2","MWFqPp","Oc3sTL","pLbCP4","aunxON"]]);
