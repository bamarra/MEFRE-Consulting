(this.$WP=this.$WP||[]).push(["5miaKe",(e,t)=>{"use strict";var s,i,r,a,n,o,c,l,d,p,u,m,v,_,b,g,k,f,S,P,h,y,I,N,T,R,j=(e,t)=>{var s=t in k,[{data:i,fetching:r,error:a}]=f({query:y,variables:{socialObjects:[{objectId:String(e),objectType:g[t]}]},executeWhen:s?"afterInvalidation":"never"},{createRepost:s=>String(s.refId)===String(e)&&s.refType===g[t]?"invalidateAndRefetch":"validate"});return!r&&!a&&i&&i.socialStatistics&&i.socialStatistics.length&&i.socialStatistics[0]||null},E=e=>{if(e&&e.blockStatus){var{blockStatus:t}=e;if(t&&(t.isBlocking||t.isBlockingYou))return!1}return!0},O=e=>{var t,i,d,{current:_}=s.useRef(`RepostUploader:${Math.random()}`),{feedSectionItem:b}=e.repostPreviewProps,g=(null==(t=e.originalRepostReference)?void 0:t.id)||b.object.id||b.object.mediaBatchId||b.object.postId,k=(null==(i=e.originalRepostReference)?void 0:i.type)||b.object.__typename,f=I(g,k),S=f?f.isReposted:e.socialStatistics&&e.socialStatistics.isReposted,{styleAsShareListItem:h,openRepostModalAsLocal:y}=e,R=s.useRef(void 0),j=(e,t,s)=>{R.current&&R.current(e,t,s)},O=()=>!(!E(e.actor)||e.repostPreviewProps&&!E(e.repostPreviewProps.actor))||("function"==typeof R.current&&R.current(k,"no_permission"),!1),{loggedInUserId:w,...L}=e;if(!e.repostPreviewProps.member&&w){var U=[{id:e.loggedInUserId}];d=s.createElement(r,{query:p,variables:{userIds:U}},(({data:t})=>{var{memberProfiles:i=null}=t||{},r=i?i[0]:null,a={...e.repostPreviewProps};return a.member=r,L.repostPreviewProps=a,s.createElement(T,Object.assign({},L,{modalName:_,repostCallback:j}))}))}else d=s.createElement(T,Object.assign({},L,{modalName:_,repostCallback:j}));var C=s.createElement(s.Fragment,null,s.createElement(u,{pid:40434},(t=>s.createElement(l,{name:_,local:y},(i=>s.createElement(v,null,(r=>s.createElement("span",{onClick:s=>{S||(N(),e.onClick&&e.onClick(),c.isNativeWebview()?g&&k&&c.postToBridge("repost",1,{objectId:g,type:k}):(r(s,"repost"),t().then(O).then((e=>{e&&i()}))))},className:a(h?"btdUv S4 H3 Pd PU Pq PG _S":"bvgAb _T M _S",{xiBpW:S})},s.createElement(m,{name:"repost",className:"cpxxv"}),s.createElement("span",{className:"ui_link eAqMG socialCTA"},o(S?"reposted":h?"social_repost_on_tripadvisor":"social_repost"))))))))),d,s.createElement(P,null,(e=>{R.current=e})));return n("social_reposts")?C:null};return[()=>{S=class extends s.Component{constructor(...e){super(...e),this.successToastMessage={Review:o("success_repost_review"),Photo:o("success_repost_photo"),Video:o("success_repost_video"),ForumPost:o("success_repost_forum"),LinkPost:o("success_repost_link"),Trip:o("success_repost_trip"),MediaBatch:o("success_repost_photos")}}createToast(e,t,i){switch(t){case"success":return{node:this.successToastMessage[e],cta:s.createElement(_,{href:i?`/Profile/${i}`:"/Profile",to:{page:"Profile",username:i}},o("view_repost"))};case"error":return{node:o("repost_failure_message")};case"rate_limited":return{node:o("repost_rate_limited_v2")};case"no_permission":return{node:o("social_no_permission")};default:return{node:""}}}render(){return s.createElement(b,null,(e=>this.props.children(((t,s,i)=>{e(this.createToast(t,s,i))}))))}},P=S,(h=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"RepostStatsQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"socialObjects"}},"type":{"kind":"NonNullType","type":{"kind":"ListType","type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"SocialObjectInternalInput"}}}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"socialStatistics"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"objects"},"value":{"kind":"Variable","name":{"kind":"Name","value":"socialObjects"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"isReposted"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"repostCount"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":163}}')).__key=9396123310041,y=h,I=j,[N,T]=d.component.onTrigger((()=>t("fmDsJ-")),"RepostUploader"),R=i((e=>({loggedInUserId:e.auth.loggedInUserId})))(O),e({RepostAction:R,useUpdatedRepostStats:I})},[e=>s=e,e=>i=e.connect,e=>r=e.Query,e=>a=e.default,e=>n=e.featureIsEnabled,e=>o=e.localize,e=>c=e.NativeBridge,e=>l=e.Opener,e=>d=e,e=>p=e.ProfileQueryWithUserId,e=>u=e.SocialLoginGate,e=>m=e.Icon,e=>v=e.InteractionLogger,e=>_=e.Link,e=>b=e.Toaster,e=>(g=e.SocialObjectTypeMap,k=e.RepostedObjectTypeMap),e=>f=e.useInvalidatableQuery]]},["cDcdfi","h74DsO","5X2em-","jSLlaY","-i3PJS","535agn","Ov85iR","pT-O8u","pLbCP4","8vFdtI","JFHNGL","_qQcW3","pZzSdK","N4pTU2","t1LGYH","CXMmrT","OnmvvE"]]);
